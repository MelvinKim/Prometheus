groups:
- name: custom.rules
  rules:
  - alert: HighCpuUsage
    expr: sum(rate(container_cpu_usage_seconds_total{container_name!="",pod_name!=""}[5m])) / count(container_name) > 0.5
    for: 5m
    labels:
      severity: critical
    annotations:
      summary: "High CPU Usage ({{ $labels.pod_name }})"
      description: "{{ $labels.pod_name }} is using more than 50% CPU."

  - alert: HighMemoryUsage
    expr: sum(container_memory_usage_bytes{container_name!="",pod_name!=""}) / sum(container_spec_memory_limit_bytes{container_name!="",pod_name!=""}) > 0.5
    for: 5m
    labels:
      severity: critical
    annotations:
      summary: "High Memory Usage ({{ $labels.pod_name }})"
      description: "{{ $labels.pod_name }} is using more than 50% memory."
